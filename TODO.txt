"github.com/twelvelabs/termite/log"
"github.com/twelvelabs/termite/rest"
"github.com/twelvelabs/termite/run"

RESTClient{
    Client: http.Client
}
RESTClient := rest.NewRESTClient()
rest.NewRESTClient().Stub()
    replaces Client.Transport w/ registry, returns self
rest.NewRESTClient().RegisterStub()
    creates stub, delegates to Client.Transport.RegisterStub(), returns self

RESTClient.RegisterStub(
    // rest.Request("GET", "some/path"),
    // rest.RequestWithQuery("GET", "some/path", query),
    rest.Get("some/path"),
    rest.StringResponse(`{"foo": "bar"}`),
    // rest.WithHeader(
    //     "X-Something", "lol",
    //     rest.StringResponse(`{"foo": "bar"}`),
    // ),
    // rest.WithStatus(
    //     201,
    //     rest.StringResponse(`{"foo": "bar"}`),
    // ),
    // rest.JSONResponse(someStruct),
    // rest.FileResponse("testdata/something.json"),
)

CmdClient{
    stubbed: bool
    stubs: []*stub{}
}

CmdClient := run.NewCmdClient()
CmdClient := run.NewCmdClient().Stub()
CmdClient.RegisterStub(
    run.Match("echo foo"),
    run.Response("foo", 0),
    // run.RegexMatch("^echo\s+(.+)$"),
    // run.RegexResponse("$1", 0),
)

a.CmdClient.NewCommand("echo", "foo")
    cmd := exec.Command(...)
    return cmdWrapper{ Cmd: cmd, cmdClient: c }


cmdWrapper{
    *exec.Cmd
    cmdClient *run.CmdClient
}
func (cw *cmdWrapper) Output() error {
    if !cw.cmdClient.Stubbed() {
        return cw.Cmd.Output()
    }
    stub := cw.cmdClient.MatchStub(cw.Cmd.Args) // should set matched && output
    if stub == nil {
        panic(...)
    }
    return stub.Output()
}

func (cw *cmdWrapper) Run() error {
    if !cw.cmdClient.Stubbed() {
        return cw.Cmd.Run()
    }
    stub := cw.cmdClient.MatchStub(cw.Cmd.Args) // should set matched && output
    if stub == nil {
        panic(...)
    }
    return stub.Run()
}
